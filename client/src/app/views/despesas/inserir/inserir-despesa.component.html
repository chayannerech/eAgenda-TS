<main class="container-fluid app-container-componente">
  <app-titulo [componenteCss]='"despesas"' [titulo]='"Cadastrar despesa"' [icone]='"currency_exchange"'></app-titulo>

  <div class="app-container-form">
    <form [formGroup]="despesaForm" (ngSubmit)="cadastrar()">

      <mat-form-field class="app-form-field">
        <mat-label>Descrição</mat-label>
        <input formControlName="descricao" matInput placeholder="Ex: Não lavar o cachorro" />
        <mat-icon matSuffix color="primary">subtitles</mat-icon>
        <mat-error *ngIf="descricao!.invalid && descricao?.errors?.['required']">
          A descrição é obrigatória!
        </mat-error>
        <mat-error *ngIf="descricao!.invalid && descricao?.errors?.['minlength']">
          A descrição precisa conter ao menos 3 caracteres!
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" class="app-form-field">
        <mat-label>Valor</mat-label>
        <div class="app-btns-personalizados">
          <input formControlName="valor" matInput type="number" placeholder="Ex: 100" />
          <div class="mb-3">
            <button type="button" (click)="incrementar()"><mat-icon>arrow_drop_up</mat-icon></button>
            <button type="button" (click)="decrementar()"><mat-icon>arrow_drop_down</mat-icon></button>
          </div>
        </div>
        <mat-icon class="mt-1" matSuffix color="primary">attach_money</mat-icon>
        <mat-error *ngIf="valor!.invalid && valor?.errors?.['min']">
          O valor é obrigatório!
        </mat-error>
        <mat-error *ngIf="valor!.invalid && valor?.errors?.['max']">
          Não avacalhe
        </mat-error>
      </mat-form-field>

      <div class="app-input-forjado d-lg-flex app-form-field">
        <mat-label class="me-5 mat-label">Forma de pagamento*</mat-label>
        <div class="align-itens-center text-center">
          <mat-radio-group formControlName="formaPagamento" aria-label="Tipo de Local">
            <mat-radio-button value = '0' class="me-4 mat-label">Pix</mat-radio-button>
            <mat-radio-button value = '1' class="me-4">Dinheiro</mat-radio-button>
            <mat-radio-button value = '2' class="me-4">Cartão</mat-radio-button>
          </mat-radio-group>
        </div>
      </div>

      <mat-form-field class="app-form-field">
        <mat-label>Data</mat-label>
        <input matInput [matDatepicker]="picker" formControlName="data" placeholder="Escolha uma data">
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
        <mat-error *ngIf="data?.invalid && data?.errors?.['required']">
          A data é obrigatória!
        </mat-error>
      </mat-form-field>

      <div class="app-input-forjado mb-0 p-3">
        <mat-label [ngStyle]="{color: semCategorias ? '#ffb0b0' : '#fff0ffdc'}">
          Categorias*
        </mat-label>
        <div class="row mx-1 mt-3">
          <div *ngFor="let cat of categoriasSelecionadas" class="col-sm-5 col-md-4 col-xxl-3">
            <div class="app-card-categorias">
              <p class="ms-2 mb-0 flex-grow-1">{{cat.titulo}}</p>
              <a mat-icon-button matTooltip="Remover categoria" (click)="removerCategoria(cat)">
                <mat-icon class="app-btn-remover-cat">delete</mat-icon>
              </a>
            </div>
          </div>
        </div>
        <mat-form-field class="app-form-field mt-4">
          <mat-label>Inserir categorias</mat-label>
          <mat-select formControlName="categoriasSelecionadasNome">
            <mat-option *ngFor="let cat of categorias" [value]="cat.id" (click)="selecionarCategoria(cat)">
              {{ cat.titulo }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <mat-error *ngIf="semCategorias" class="ms-3">
        Insira ao menos uma categoria
      </mat-error>

      <app-submeter-form [rota]='"/despesas"'></app-submeter-form>
    </form>
  </div>
</main>
